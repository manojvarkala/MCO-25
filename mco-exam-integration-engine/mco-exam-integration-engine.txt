<?php
/**
 * Plugin Name:       MCO Exam Integration Engine
 * Description:       Provides the core data API, CPTs, and SSO functionality for the Annapoorna Infotech headless examination app.
 * Version:           2.7.2
 * Author:            Annapoorna Infotech (Manoj Balakrishnan)
 * Author URI:        https://annapoornainfo.com/
 * Text Domain:       mco-exam-integration
 */

if (!defined('ABSPATH')) exit;

// Define plugin constants
define('MCO_EXAM_PLUGIN_DIR', plugin_dir_path(__FILE__));
define('MCO_EXAM_PLUGIN_URL', plugin_dir_url(__FILE__));

// Include necessary files
require_once MCO_EXAM_PLUGIN_DIR . 'includes/mco-cpts.php';
require_once MCO_EXAM_PLUGIN_DIR . 'includes/mco-admin.php';
require_once MCO_EXAM_PLUGIN_DIR . 'includes/mco-data.php';
require_once MCO_EXAM_PLUGIN_DIR . 'includes/mco-api.php';
require_once MCO_EXAM_PLUGIN_DIR . 'includes/mco-shortcodes.php';

// Add plugin action links
function mco_add_action_links($links) {
    $settings_link = '<a href="' . admin_url('admin.php?page=mco-exam-settings') . '">Settings</a>';
    array_unshift($links, $settings_link);
    return $links;
}
add_filter('plugin_action_links_' . plugin_basename(__FILE__), 'mco_add_action_links');

// Activation hook for rewrite rules
function mco_plugin_activate() {
    mco_register_custom_post_types();
    flush_rewrite_rules();
}
register_activation_hook(__FILE__, 'mco_plugin_activate');

// Deactivation hook for rewrite rules
function mco_plugin_deactivate() {
    flush_rewrite_rules();
}
register_deactivation_hook(__FILE__, 'mco_plugin_deactivate');
?>